#!/bin/bash
# Automated Security Fix Script
# Generated by Fedora Security Hardening Toolkit
# Generated on: 2025-07-07 22:32:38

set -euo pipefail

echo 'Starting automated security fixes...'

# Fix 1: Firewall logging disabled (Priority: HIGH)
echo 'Applying fix 1: Firewall logging disabled'
sudo firewall-cmd --set-log-denied=all --permanent && sudo firewall-cmd --reload
echo 'Fix applied successfully'

# Fix 2: Kernel parameter net.ipv4.conf.all.log_martians not optimally configured (Priority: MEDIUM)
echo 'Applying fix 2: Kernel parameter net.ipv4.conf.all.log_martians not optimally configured'
echo "net.ipv4.conf.all.log_martians = 1" >> /etc/sysctl.conf
echo 'Fix applied successfully'

echo 'All automated fixes completed!'
echo 'Please run the security audit again to verify fixes.'