#!/bin/bash
# Automated Security Fix Script
# Generated by Fedora Security Hardening Toolkit
# Generated on: 2025-07-07 22:15:46

set -euo pipefail

echo 'Starting automated security fixes...'

# Fix 1: Recidive jail not configured (Priority: MEDIUM)
echo 'Applying fix 1: Recidive jail not configured'
# Configure recidive jail in /etc/fail2ban/jail.local
echo 'Fix applied successfully'

# Fix 2: Firewall logging disabled (Priority: HIGH)
echo 'Applying fix 2: Firewall logging disabled'
sudo firewall-cmd --set-log-denied=all --permanent && sudo firewall-cmd --reload
echo 'Fix applied successfully'

# Fix 3: Kernel parameter net.ipv4.conf.all.log_martians not optimally configured (Priority: MEDIUM)
echo 'Applying fix 3: Kernel parameter net.ipv4.conf.all.log_martians not optimally configured'
echo "net.ipv4.conf.all.log_martians = 1" >> /etc/sysctl.conf
echo 'Fix applied successfully'

# Fix 4: Risky service avahi-daemon is active (Priority: MEDIUM)
echo 'Applying fix 4: Risky service avahi-daemon is active'
sudo systemctl disable --now avahi-daemon
echo 'Fix applied successfully'

# Fix 5: Risky service cups is active (Priority: MEDIUM)
echo 'Applying fix 5: Risky service cups is active'
sudo systemctl disable --now cups
echo 'Fix applied successfully'

echo 'All automated fixes completed!'
echo 'Please run the security audit again to verify fixes.'